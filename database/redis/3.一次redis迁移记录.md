## 背景介绍

公司最近在迁移服务器, 有一些老的服务使用的redis之前是自建的, 趁着这个机会他们打算迁移到我们集中管理的一个开发平台, redis是6.2版本, 部署方式为3个节点的主从.

## 操作过程

因为之前有过经验, 先新建一个redis, 然后直接把redis的rdb文件直接拷贝到新的集群, 但是发现拷贝以后, 重启实例数据就没了, 后来经过查询, 原因是开启了AOF模式, 关闭后重新尝试就可以了.


# 总结

这里有几个知识点:

1. redis有两个主要的数据持久化方式, 一个是RDB(Redis Database),这个是周期性保存内存数据到硬盘; 另一个是AOF(Append-only File)这个是把所有的写入操作记录到一个文件, 然后异步写入文件.
2. AOF数据丢失的时间更短, 一般几秒的; RDB的看配置规则, 丢失的数据更多

我之前只记得拷贝RDB文件, 其实也可以拷贝AOF文件. 关键是看`appendonly yes`配置, 启用的话就优先读取aof文件, 否则才会读取rdb文件.
