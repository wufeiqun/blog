## 背景介绍

公司的MySQL部署在Kubernetes里面, 有一次遇到了一个异常的查询请求, 开发同学想要知道这个账号是哪个服务在连接, 从数据库的`show processlist`中可以看到请求的IP和账号.

## 解决方式

请求的IP是k8s的POD网段的IP, 我以为是一个普通的POD, 所以使用如下的promQL查询语句:

```
kube_pod_info{pod_ip="10.80.9.111"}
```

但是查询不到. 可以我又可以在另一个POD中ping通, 所以该节点是存在的. 后来通过ChatGPT沟通, 确定这个IP是通过NodePort访问Kubernetes里面服务的时候kube proxy的NAT代理IP.

因为我们只暴露了一个Node节点, 所以我直接去该节点上执行如下命令后找到了该IP:

```
ip a
```

