服务启动的时候所以来的第三方服务挂了怎么办?

一个服务一般会依赖很多其它的服务, 比如Mysql/Redis/ElasticSearch, 还有一些其它的服务, 如果这个服务启动的时候, 它所依赖的服务没启动, 那么这个服务应该启动吗, 还是报错?

1. 不推荐的方式

也就是该服务启动的时候检查一下自己依赖的服务, 发现依赖的服务中有没起来的, 那么我就直接报错Crash掉. 不建议这么做, 如果多个服务都这么做的话, 就会形成CrashLoopBackOff, 循环依赖, 最后谁也启动不起来.

2. 推荐的方式

  2.1 该服务正常启动, 即使依赖的服务有挂掉的. 对应到Kubernetes的探活上就是让Liveness正常.
  2.2 对依赖的服务进行重试, 直到成功为止, 然后让Readyness正常