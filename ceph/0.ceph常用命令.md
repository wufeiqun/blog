## 状态查询

* 查看全局健康状态

`ceph -s`

* 查看集群所有的进程

`ceph orch ps` 可以指定服务类型: `ceph orch ps --daemon-type mon`

## 日常维护

* 维护服务器节点

在维护Ceph集群的过程中免不了某一台服务器某个零部件坏了, 如果硬盘彻底坏了, 那就把该OSD 标记为out, 如果服务器只是重启一下, 那就设置一下noout.

```shell
Ceph维护服务器/硬盘相关命令

1. ceph osd out {osd.id}

这种方式会直接触发数据迁移, 当然迁移也不一定是从这个被out的节点上, 而是从其它正常的节点上. 这个命令一般是用于硬盘坏了, 彻底不用了.

2. ceph osd down {osd.id}

这个命令会把osd下线, 流量就不会请求到该osd了, 不过如果mon_osd_down_out_interval时间段(默认600秒)还没有恢复, 那么ceph集群也会触发再平衡, 这种一般是短时间操作会用到, 比如仅仅重启一下某一个节点.

3. ceph osd set noout

 这个命令会阻止集群将OSD标记为out, 也就阻止了集群重新平衡数据, 可以直接操作某一个节点, 不影响业务使用, 如果某一个节点在osd_heartbeat_grace(默认20秒)内没有通信, 那么集群就会把该节点设置为down.
 处理完以后执行ceph osd unset noout 即可.
```



